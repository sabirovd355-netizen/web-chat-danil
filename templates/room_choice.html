{% extends "base.html" %}

{% block title %}Выбор Комнаты{% endblock %}

{% block content %}
<!-- 
    Этот скрипт загружает Tailwind CSS, чтобы стили работали. 
    В реальном приложении он может быть вынесен в base.html
-->
<script src="https://cdn.tailwindcss.com"></script>
<style>
    /* Используем шрифт Inter для современного вида */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
    body {
        font-family: 'Inter', sans-serif;
    }
</style>

<div class="min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4">
    <div class="w-full max-w-md bg-white dark:bg-gray-800 p-8 md:p-10 shadow-2xl rounded-xl space-y-6">
        <h1 class="text-3xl font-extrabold text-center text-gray-900 dark:text-white">
            Добро пожаловать в Чат!
        </h1>
        
        <!-- Отображение информации о текущем пользователе, используя переменную, переданную из Flask -->
        <div class="text-center p-3 bg-indigo-50 dark:bg-indigo-900/50 rounded-lg shadow-inner">
            <p class="text-lg font-medium text-indigo-700 dark:text-indigo-300">
                Вы вошли как: 
                <!-- Предполагается, что 'user_name' передается в контексте шаблона -->
                <span class="font-bold">{{ user_name }}</span>
            </p>
        </div>

        <!-- Форма для выбора/создания комнаты -->
        <form method="POST" action="{{ url_for('room_choice') }}" class="space-y-6">
            <div class="relative">
                <label for="room_name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                    Введите название комнаты
                </label>
                <input 
                    type="text" 
                    id="room_name" 
                    name="room_name" 
                    required 
                    minlength="3"
                    maxlength="50"
                    placeholder="Например, 'Общий', 'Технологии', 'Проект-Z'"
                    class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm 
                           focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 
                           text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400"
                >
            </div>
            
            <button 
                type="submit" 
                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-md 
                       text-base font-semibold text-white bg-indigo-600 hover:bg-indigo-700 
                       focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 
                       transition duration-150 ease-in-out transform hover:scale-[1.01]"
            >
                Присоединиться к Комнате
            </button>
        </form>

        <!-- Разделитель -->
        <div class="relative">
            <div class="absolute inset-0 flex items-center" aria-hidden="true">
                <div class="w-full border-t border-gray-300 dark:border-gray-700"></div>
            </div>
            <div class="relative flex justify-center text-sm">
                <span class="px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400">
                    Или
                </span>
            </div>
        </div>

        <!-- Кнопка выхода (Logout), предполагается маршрут 'logout' -->
        <a href="{{ url_for('logout') }}" 
           class="w-full text-center block py-2 px-4 border border-transparent rounded-lg 
                  text-sm font-medium text-red-600 bg-red-100 hover:bg-red-200 
                  dark:bg-red-900/30 dark:hover:bg-red-900/50 dark:text-red-400 
                  transition duration-150 ease-in-out shadow-sm"
        >
            Выйти из учетной записи ({{ user_email }})
        </a>

        <!-- Блок для отображения Flash-сообщений (если есть) -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul class="space-y-2 mt-4">
                    {% for category, message in messages %}
                        <li class="p-3 rounded-lg text-sm {% if category == 'error' %}bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200{% else %}bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200{% endif %}">
                            {{ message }}
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}

    </div>
</div>

{% endblock %}